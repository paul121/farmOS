
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../../favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.8">
    
    
      
        <title>Authentication - farmOS 2.x Docs</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.39b8e14a.min.css">
        
          
          
          <meta name="theme-color" content="#4cae4f">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="green" data-md-color-accent="orange">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#authentication" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../../.." title="farmOS 2.x Docs" class="md-header-nav__button md-logo" aria-label="farmOS 2.x Docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 8C8 10 5.9 16.17 3.82 21.34l1.89.66.95-2.3c.48.17.98.3 1.34.3C19 20 22 3 22 3c-1 2-8 2.25-13 3.25S2 11.5 2 13.5s1.75 3.75 1.75 3.75C7 8 17 8 17 8z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            farmOS 2.x Docs
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Authentication
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="farmOS 2.x Docs" class="md-nav__button md-logo" aria-label="farmOS 2.x Docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 8C8 10 5.9 16.17 3.82 21.34l1.89.66.95-2.3c.48.17.98.3 1.34.3C19 20 22 3 22 3c-1 2-8 2.25-13 3.25S2 11.5 2 13.5s1.75 3.75 1.75 3.75C7 8 17 8 17 8z"/></svg>

    </a>
    farmOS 2.x Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1" checked>
      
      <label class="md-nav__link" for="nav-1">
        Development
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Development" data-md-level="1">
        <label class="md-nav__title" for="nav-1">
          <span class="md-nav__icon md-icon"></span>
          Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-1" type="checkbox" id="nav-1-1" checked>
      
      <label class="md-nav__link" for="nav-1-1">
        API
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API" data-md-level="2">
        <label class="md-nav__title" for="nav-1-1">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Authentication
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Authentication
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#client-libraries" class="md-nav__link">
    Client Libraries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oauth2-bearer-tokens" class="md-nav__link">
    OAuth2 Bearer Tokens
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oauth2-details" class="md-nav__link">
    OAuth2 Details
  </a>
  
    <nav class="md-nav" aria-label="OAuth2 Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scopes" class="md-nav__link">
    Scopes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clients" class="md-nav__link">
    Clients
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization-flows" class="md-nav__link">
    Authorization Flows
  </a>
  
    <nav class="md-nav" aria-label="Authorization Flows">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authorization-code-grant" class="md-nav__link">
    Authorization Code Grant
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#password-credentials-grant" class="md-nav__link">
    Password Credentials Grant
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#refreshing-tokens" class="md-nav__link">
    Refreshing Tokens
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../changes/" class="md-nav__link">
        Changes
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-2" type="checkbox" id="nav-1-2" >
      
      <label class="md-nav__link" for="nav-1-2">
        Module
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Module" data-md-level="2">
        <label class="md-nav__title" for="nav-1-2">
          <span class="md-nav__icon md-icon"></span>
          Module
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../module/" class="md-nav__link">
        Getting started
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../module/entities/" class="md-nav__link">
        Entities
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../module/fields/" class="md-nav__link">
        Fields
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../module/oauth/" class="md-nav__link">
        OAuth
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../module/roles/" class="md-nav__link">
        Roles
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../module/updates/" class="md-nav__link">
        Updates
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-3" type="checkbox" id="nav-1-3" >
      
      <label class="md-nav__link" for="nav-1-3">
        Environment
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Environment" data-md-level="2">
        <label class="md-nav__title" for="nav-1-3">
          <span class="md-nav__icon md-icon"></span>
          Environment
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../environment/" class="md-nav__link">
        Getting started
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../environment/update/" class="md-nav__link">
        Updating
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../environment/docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../environment/postgresql/" class="md-nav__link">
        PostgreSQL
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../environment/drush/" class="md-nav__link">
        Drush
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../environment/composer/" class="md-nav__link">
        Composer
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../environment/debug/" class="md-nav__link">
        Debugging
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../environment/tests/" class="md-nav__link">
        Automated tests
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../environment/code/" class="md-nav__link">
        Coding standards
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../environment/documentation/" class="md-nav__link">
        Documentation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
      
      <label class="md-nav__link" for="nav-2">
        Hosting
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Hosting" data-md-level="1">
        <label class="md-nav__title" for="nav-2">
          <span class="md-nav__icon md-icon"></span>
          Hosting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../hosting/migration/" class="md-nav__link">
        1.x Migration
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#client-libraries" class="md-nav__link">
    Client Libraries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oauth2-bearer-tokens" class="md-nav__link">
    OAuth2 Bearer Tokens
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oauth2-details" class="md-nav__link">
    OAuth2 Details
  </a>
  
    <nav class="md-nav" aria-label="OAuth2 Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scopes" class="md-nav__link">
    Scopes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clients" class="md-nav__link">
    Clients
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization-flows" class="md-nav__link">
    Authorization Flows
  </a>
  
    <nav class="md-nav" aria-label="Authorization Flows">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authorization-code-grant" class="md-nav__link">
    Authorization Code Grant
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#password-credentials-grant" class="md-nav__link">
    Password Credentials Grant
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#refreshing-tokens" class="md-nav__link">
    Refreshing Tokens
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="authentication">Authentication<a class="headerlink" href="#authentication" title="Permanent link">&para;</a></h1>
<p>farmOS includes an OAuth2 Authorization server for providing 1st and 3rd party
clients access to the farmOS API. Rather than using a user's username and
password to both <em>authorize and authenticate</em> a request, OAuth2 requires
users to complete an <em>authorization flow</em> that generates an <code>access_token</code>
to be used for authentication. Access tokens are provided to both 1st and
3rd party clients who wish to access the server's protected resources. Clients
store the <code>access token</code> instead of the user's credentials, which makes it a
more secure authentication method.</p>
<p>Read more about the <a href="https://oauth.net/2/">OAuth 2.0 standards</a>.</p>
<h2 id="client-libraries">Client Libraries<a class="headerlink" href="#client-libraries" title="Permanent link">&para;</a></h2>
<p>The <a href="https://github.com/farmOS/farmOS.py">farmOS.py</a> and
<a href="https://github.com/farmOS/farmOS.js">farmOS.js</a> client libraries use the
OAuth2 protocol to interact with the farmOS API.</p>
<h2 id="oauth2-bearer-tokens">OAuth2 Bearer Tokens<a class="headerlink" href="#oauth2-bearer-tokens" title="Permanent link">&para;</a></h2>
<p>Once you have an OAuth2 token, you can authenticate requests to the farmOS
server by including an <code>Authentication: Bearer {access_token}</code> header.</p>
<h2 id="oauth2-details">OAuth2 Details<a class="headerlink" href="#oauth2-details" title="Permanent link">&para;</a></h2>
<p>The OAuth protocol defines a process where users <em>authorize</em> 1st and 3rd
party <em>clients</em> with <em>scoped</em> access to data on the server. The following
describes the details necessary for using OAuth2 authorization with a farmOS
server.</p>
<h3 id="scopes">Scopes<a class="headerlink" href="#scopes" title="Permanent link">&para;</a></h3>
<p>OAuth Scopes define different levels of permission. The farmOS server
implements scopes as roles associated with OAuth clients. This means that users
will authorize clients with roles that determine how much access they have
to data on the server.</p>
<h3 id="clients">Clients<a class="headerlink" href="#clients" title="Permanent link">&para;</a></h3>
<p>An OAuth Client represents a 1st or 3rd party integration with the farmOS
server. Clients are uniquely identified by a <code>client_id</code> and are
configured to use different <code>scopes</code>.</p>
<p>The core <code>farm_api</code> module provides a default client with
<code>client_id = farm</code>. If you are writing a script that communicates with <em>your</em>
farmOS server via the API, you should use this client to authorize access and
generate an <code>access_token</code> for authentication.</p>
<p>If you are creating a third party integration with farmOS, see the
<a href="/development/module/oauth">OAuth</a> page of the farmOS module development docs
for steps to create an OAuth Client.</p>
<h3 id="authorization-flows">Authorization Flows<a class="headerlink" href="#authorization-flows" title="Permanent link">&para;</a></h3>
<p>The <a href="https://oauth.net/2/">OAuth 2.0 standards</a> outline 5
<a href="https://oauth.net/2/grant-types/">Oauth2 Grant Types</a> to be used in an OAuth2
Authorization Flow - They are the <em>Authorization Code, Implicit, Password
Credentials, Client Credentials</em> and <em>Refresh Token</em> Grants. The
<a href="#authorization-code-grant">Authorization Code</a> and
<a href="#refreshing-tokens">Refresh Token</a> grants are the only Authorization Flows
recommended by farmOS for use with 3rd party clients.</p>
<p><strong>NOTE:</strong> Only use the <strong>Password Grant</strong> if the client can be trusted with a
farmOS username and password (this is considered <em>1st party</em>). The
<strong>Client Credentials Grant</strong> is often used for machine authentication not
associated with a user account. The client credentials grant should only be
used if a <code>client_secret</code> can be kept secret. If connecting to multiple
farmOS servers, each server should use a different secret. This is
challenging due to the nature of farmOS being a self-hosted application.</p>
<h4 id="authorization-code-grant">Authorization Code Grant<a class="headerlink" href="#authorization-code-grant" title="Permanent link">&para;</a></h4>
<p>The Authorization Code Grant is most popular for 3rd party client
authorization.</p>
<p>Requesting resources is a four step process:</p>
<p><strong>First</strong>: the client sends a request to the farmOS server <code>/oauth/authorize</code>
endpoint requesting an <code>Authorization Code</code>. The user logs in and authorizes
the client to have the OAuth Scopes it is requesting.</p>
<pre><code>Copy this link to browser -
http://localhost/oauth/authorize?response_type=code&amp;client_id=farmos_development&amp;scope=user_access&amp;redirect_uri=http://localhost/api/authorized&amp;state=p4W8P5f7gJCIDbC1Mv78zHhlpJOidy
</code></pre>
<p><strong>Second</strong>: after the user accepts, the server redirects
to the <code>redirect_uri</code> with an authorization <code>code</code> and <code>state</code> in the query
parameters.</p>
<pre><code>Example redirect url from server:
http://localhost/api/authorized?code=9eb9442c7a2b011fd59617635cca5421cd089943&amp;state=p4W8P5f7gJCIDbC1Mv78zHhlpJOidy
</code></pre>
<p><strong>Third</strong>: copy the <code>code</code> and <code>state</code> from the URL into the body of a POST
request. The <code>grant_type</code>, <code>client_id</code>, <code>client_secret</code> and <code>redirect_uri</code> must
also be included in the POST body. The client makes a POST request to the
<code>/oauth/token</code> endpoint to retrieve an <code>access_token</code> and <code>refresh_token</code>.</p>
<pre><code>foo@bar:~$ curl -X POST -d "grant_type=authorization_code&amp;code=ae4d1381cc67def1c10dc88a19af6ac30d7b5959&amp;client_id=farmos_development&amp;redirect_uri=http://localhost/api/authorized" http://localhost/oauth/token
{"access_token":"3f9212c4a6656f1cd1304e47307927a7c224abb0","expires_in":"10","token_type":"Bearer","scope":"user_access","refresh_token":"292810b04d688bfb5c3cee28e45637ec8ef1dd9e"}
</code></pre>
<p><strong>Fourth</strong>: the client sends the access token in the request header to access protected
resources. The header is an Authorization header with a Bearer token:
 <code>Authorization: Bearer access_token</code></p>
<pre><code>foo@bar:~$ curl --header "Authorization: Bearer b872daf5827a75495c8194c6bfa4f90cf46c143e" http://localhost/farm.json
{"name":"farmos-server","url":"http:\/\/localhost","api_version":"1.1","user":{"uid":"1","name":"admin", ....
</code></pre>
<h4 id="password-credentials-grant">Password Credentials Grant<a class="headerlink" href="#password-credentials-grant" title="Permanent link">&para;</a></h4>
<p><strong>NOTE:</strong> Only use the <strong>Password Grant</strong> if the client can be trusted with a
farmOS username and password (this is considered <em>1st party</em>).</p>
<p>The Password Credentials Grant uses a farmOS <code>username</code> and <code>password</code> to
retrieve an <code>access_token</code> and <code>refresh_token</code> in one step. For the user, this
is the simplest type of <em>authorization.</em> Because the client can be trusted with
their farmOS Credentials, a users <code>username</code> and <code>password</code> can be collected
directly into a login form within the client application. These credentials are
then used (not stored) to request tokens which are used for <em>authentication</em>
with the farmOS server and retrieving data.</p>
<p>Requesting protected resources is a two step process:</p>
<p><strong>First</strong>, the client sends a POST request to the farmOS server <code>/oauth/token</code>
endpoint with <code>grant_type</code> set to <code>password</code> and a <code>username</code> and <code>password</code>
included in the request body.</p>
<pre><code>$ curl -X POST -d "grant_type=password&amp;username=username&amp;password=test&amp;client_id=farm&amp;scope=user_access" http://localhost/oauth/token
{"access_token":"e69c60dea3f5c59c95863928fa6fb860d3506fe9","expires_in":"300","token_type":"Bearer","scope":"user_access","refresh_token":"cead7d46d18d74daea83f114bc0b512ec4cc31c3"}
</code></pre>
<p><strong>second</strong>, the client sends the <code>access_token</code> in the request header to access protected
resources. The header is an Authorization header with a Bearer token:
 <code>Authorization: Bearer access_token</code></p>
<pre><code>foo@bar:~$ curl --header "Authorization: Bearer e69c60dea3f5c59c95863928fa6fb860d3506fe9" http://localhost/farm.json
{"name":"farmos-server","url":"http:\/\/localhost","api_version":"1.1","user":{"uid":"1","name":"admin", ....
</code></pre>
<h4 id="refreshing-tokens">Refreshing Tokens<a class="headerlink" href="#refreshing-tokens" title="Permanent link">&para;</a></h4>
<p>The <code>refresh_token</code> can be used to retrieve a new <code>access_token</code> if the token
has expired.</p>
<p>It is a one step process:</p>
<p>The client sends an authenticated request to the <code>/oauth/token</code>endpoint with
<code>grant_type</code> set to <code>refresh_token</code> and includes the <code>refresh_token</code>,
<code>client_id</code> and <code>client_secret</code> in the request body.</p>
<pre><code>foo@bar:~$ curl -X POST -H 'Authorization: Bearer ad52c04d26c1002084501d28b59196996f0bd93f' -d 'refresh_token=52e7a0e12e8ddd08b155b3b3ee385687fef01664&amp;grant_type=refresh_token&amp;client_id=farmos_api_client&amp;client_secret=client_secret' http://localhost/oauth/token
{"access_token":"acdbfabb736e42aa301b50fdda95d6b7fd3e7e14","expires_in":"300","token_type":"Bearer","scope":"user_access","refresh_token":"b73f4744840498a26f43447d8cf755238bfd391a"}
</code></pre>
<p>The server responds with an <code>access_token</code> and <code>refresh_token</code> that can be used
in future requests. The previous <code>access_token</code> and <code>refresh_token</code> will no
longer work.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Introduction
              </div>
            </div>
          </a>
        
        
          <a href="../changes/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Changes
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>. farmOS is a <a href="/community/trademark">registered trademark</a> of <a href="http://mstenta.net">Michael Stenta</a>
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/vendor.18f0862e.min.js"></script>
      <script src="../../../assets/javascripts/bundle.994580cf.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: [],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>